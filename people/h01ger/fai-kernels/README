README
------

This package contains kernel packages for FAI (Fully Automatic
Installation). The kernels use a NFS mounted filesystem for the root
file system (called nfsroot, see also
/usr/src/kernel-source-2.4.27/Documentation/nfsroot.txt ). The kernel
supports both boot protocols (BOOTP and DHCP) for getting its network
information (IP address, netmask, gateway, broadcast address). These
kernels are only tested on i386 arch. For other architectures build a
kernel by your own.


Important note: The driver for the network card must be compiled into
		the kernel. Do not use a kernel module for it. If you
		got several NICs plugged into your box, the first one
		the kernel finds will be used.


How to build a custom 2.4.X fai kernel
--------------------------------------

The fai-kernels package contains a 2.4.X kernel that supports both the
BOOTP and the DHCP protocol. You must enable one of the protocols by
adding the kernel parameter ip=bootp or ip=dhcp (see also nfsroot.txt of
the kernel sources). 

If you need to compile a custom kernel, start with the config file from
the fai-kernels package.

  # cd kernel-sources-2.4.27
  # zcat /usr/share/doc/fai-kernels/config-2.4.27.gz >.config
  # make menuconfig

When you've saved your kernel configuration, build the kernel package
using:
 
  make-kpkg --rootcmd fakeroot --append-to-version -fai --revision 2 kernel-image 
 
This will create the file kernel-image-2.4.27-fai_2_i386.deb,
which can be used by FAI. Copy this file to /usr/lib/fai/kernels
and specify it in /etc/fai.conf

KERNELPACKAGE=/usr/lib/fai/kernel/kernel-image-2.4.27-fai_2_i386.deb

Then you can set up FAI calling fai-setup or rebuild the nfsroot with
the command make-fai-nfsroot. 

Then you can build a new FAI boot floppy with

  # make-fai-bootfloppy -f /tmp/fai-bootfloppy -d b

How to save space on the boot floppy
------------------------------------
If you need a smaller kernel image to fit on a floppy disk, you can
remove some network drivers, that you don't need for booting and
mounting the nfsroot. If you have a math coprocessor, disable the math
emulation (nearly 80k). Here's a list for kernel 2.4.24 with the size
of some drivers.

20144 8139too.o
21564 pcnet32.o
21868 3c505.o
21932 dl2k.o
25292 natsemi.o
34040 3c59x.o
50187 tulip.o
55796 tg3.o
62936 serial.o
66484 e100.o
74244 typhoon.o
84056 e1000.o
165343 sk98lin.o

The homepage for FAI is:

        http://www.informatik.uni-koeln.de/fai/

----------------------------------------------------------------------
            Thomas Lange        
Institut fuer Informatik        mailto:lange@informatik.Uni-Koeln.DE
   Universitaet zu Koeln
            Pohligstr. 1        Telefon: +49 221 470 5303
             50969 Koeln        Fax    : +49 221 470 5317

1024D/AB9B66FD AEA6 A8C1 BD8E 67C4 8EF6  8BCA DC13 E54E AB9B 66FD
----------------------------------------------------------------------
Copyright (c) 2000-2005 Thomas Lange. All rights reserved.
