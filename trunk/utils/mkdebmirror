#! /bin/sh

# Thomas Lange, lange@informatik.uni-koeln.de, (c) 2001

# create partitial debian mirror using debmirror from Joey and rsync
# http://cvs.kitenet.net/joey-cvs/bin/debmirror

rsync_disks() {

    # get the boot disks
    rsync --delete -av ftp2.de.debian.org::debian/dists/$1/main/disks-$arch $destdir/dists/$1/main/
}

host=ftp2.de.debian.org
#host=ftp.freenet.de
destdir=/files/scratch/
arch=i386
debug="--debug"
debug="$*"
defopt="$debug --getcontents --host=$host --nosource --dist=stable,testing --ignore=Release"
defopt="$debug --getcontents --host=$host --nosource --dist=stable,unstable,testing,woody,potato"

# even one should not mirror the security site, but I will do it.
debmirror $destdir/debian-security $debug --nosource -h security.debian.org -r debian-security -d stable/updates --arch=$arch,all --nocleanup

debmirror $destdir/debian --arch=$arch $defopt --ignore="|disks-$arch/|security/" --adddir="dists/proposed-updates"

debmirror $destdir/debian-non-US $defopt -r /debian-non-US -s non-US/main,non-US/contrib,non-US/non-free

rsync_disks stable
rsync_disks testing
#rsync_disks unstable
