#! /usr/bin/cfengine

control:
   OutputPrefix = ("cfengine")
   actionsequence = ( editfiles )
   EditFileSize = ( 30000 )

editfiles:
# Install users for netscape kiosk-mode
   WWWKIOSK::
	{ ${target}/etc/passwd
	  AppendIfNoSuchLine "halt:${haltpw}:0:0:,,,:/root/:/root/.shutdown.sh"
	  AppendIfNoSuchLine "opac:${opacpw}:20000:20000:OPAC WI/INF,,,:/home/opac:/bin/bash"
	}
	
	{ ${target}/etc/group
	  AppendIfNoSuchLine "opac:*:20000:"
	}

	#leave only one tty for login. First tty has the entry
        #..:2345:... in inittab
	{ ${target}/etc/inittab
	  HashCommentLinesContaining ":23:respawn:/sbin/getty"
        }

# add an account so everybody can shutdown the notebook
# this account has no password!
   NOTEBOOK::
	{ ${target}/etc/passwd
	  AppendIfNoSuchLine "poweroff::0:0:poweroff account:/tmp:/sbin/poweroff"
	}

   CS_KOELN::

	# enable remote connect to the Xserver
	{ ${target}/etc/X11/xinit/xserverrc
	  ReplaceAll "-nolisten tcp" With " "
	}

	# a2ps write to stdout
	{ ${target}/etc/a2ps-site.cfg
	  AppendIfNoSuchLine "Options: --borders=no --output=-"
	}
	# insert some important hosts
	{ ${target}/etc/hosts
	  AppendIfNoSuchLine "134.95.9.10     rubens"
	}

	{ ${target}/etc/ssh/sshd_config
	  ReplaceAll "X11Forwarding no"
	        With "X11Forwarding yes"
	}

